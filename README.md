
# UAV package delivery for Urban Air Mobility (UAM)

## Introduction

This project focuses on simulating a package delivery system utilizing Unmanned Aerial Vehicles (UAVs) within the context of Urban Air Mobility (UAM). The primary objective is to employ the A* algorithm to determine an optimal, obstacle-free path from point A to point B for the UAVs within urban environments. The aim is to expedite the delivery process and maximize the number of deliveries within a specified timeframe in UAM operations.


## Required Technologies

**Note:** You must have a license to use MATLAB or any products from MathWorks. See MathWorks page for toolboxes version compatible with newer versions of MATLAB/Simulink.

1. **Technologies from MathWorks**

   1. MATLAB R2023B 
      - Aerospace Blockset version 6.0
      - Aerospace Toolbox version 4.4
      - Computer Vision Toolbox version 10.4
      - Control System Toolbox version 10.13
      - Image Processing Toolbox version 11.7
      - Navigation Toolbox version 2.4
      - Optimization Toolbox version 9.5
      - Partial Differential Equation Toolbox version 3.10
      - Signal Processing Toolbox version 9.2
      - Simscape version 5.5
      - Simscape Electrical version 7.9
      - Simulink version 10.7
      - Simulink 3D Animation version 9.6
      - UAV Toolbox version 1.5
   2. Simulink
2. Blender
3. Python



## Setup

### Step 1: Save Maps
Save your maps - with or without obstacles in STL format - under `UAVPathPlanning/Maps`. **See `UAVPathPlanning/STLMaps` directory for more maps**.

### Step 2: Map Data Loading

#### Case 1 - Load New Map Data
1. Open `RunAll.m` under `UAVPathPlanning/AlgoStuff`.
2. Set the variable `map` to the name of your map as in `map = ".\Maps\manhattan.stl";`.
3. If you'd like obstacles in your simulation:
    - Specify the name of your map that has obstacles to the variable `mapObstacles`.
    - Set `enableObstacles` to `True`.
    Otherwise, set `enableObstacles` to `False`.
4. Open `VariableConfig.m` under `UAVPathPlanning/AlgoStuff`.
    - Set the `startPose` and `goalPose` for the A* algorithm and for the UAV starting and destination points, respectively (e.g., `startPose = [meters, meters, radians]`).
5. Execute `RunAll.m` script to start the simulation.
6. (Optional) You may want to save your 2D occupancy map data for future use (see Case 2).

#### Case 2 - Use Saved Map Data
Note: This step assumes you have completed Case 1 or you are using our testing data.
1. Open `Root.m` under `UAVPathPlanning/AlgoStuff`.
2. Follow steps 2 and 3 from Case 1. This time, the changes are made in `Root.m`.
3. Repeat step 4 from Case 1, but make the changes in `VariableConfiguration.m`.
4. Execute the `Root.m` script to start the simulation.



## Demonstration
<img src="https://lucid.app/publicSegments/view/ee6dbe6a-e682-4a6c-8698-8dc353f0018c/image.jpeg" alt="MathWorks - UAV Path Planning Percent Error visualization" width="600" height="600">

## Results

After completing either Case 1 or Case 2 in Setup, use the `SaveData.m` file to save the trajectory the path followed. Next, open `Testing.py` under `UAVPathPlanning/Testing` to find the accuracy of the UAV's trajectory relative to the expected path generated by the A* algorithm. This step required you have Python installed.

<img src="https://lucid.app/publicSegments/view/680fbf2f-0056-44ba-a47d-861f78e49414/image.jpeg" alt="MathWorks - UAV Path Planning Percent Error visualization" width="600" height="260">



## Future Development

1. **Account for changes in the UAVâ€™s weight:**
   - Consider the following cases:
     - **Case 1:** After delivering a package from point A to B, the UAV's total weight changes, potentially requiring PID value adjustments.
     - **Case 2:** The UAV drops the package mid-flight, requiring real-time PID value adjustments to maintain a smooth and expected path.
     - **Solution:** Test the drone's behavior with increased weight, record outputs, and find optimal PID settings for smooth navigation. Repeat for weight decreases and adjust PID values accordingly during mid-flight or after the package is delivered.

2. **Use a higher fidelity environment:**
   - Use Unreal Engine by Epic Games for creating a simulated urban environment.
   - **Benefits:**
     - Unreal Engine provides high-quality, realistic graphics and rendering capabilities (e.g., humans, birds, cars).
     - Advanced physics simulation allows for realistic interactions (e.g., collision, gravity, friction) between objects and environmental elements.
     - Dynamic lighting, effects, and weather conditions enhance the overall visual experience and overall simulation.

3. **Implement multiple drone communication:**
   - Reasons for multiple drones' communication include:
     - Adapting to dynamic environments in real-time.
     - Collaboratively gathering data over large areas efficiently.
   - Communication enables sharing sensor readings and updating covered areas in real-time to avoid conflicts.

4. **Simulation to hardware integration:**
   - The ultimate objective is to implement simulation on hardware.

## Common Errors

1. When scanning building areas in `TwoDronesSTLToOMap.m`, you may notice that some buildings are not scanned clearly or are not scanned at all. To address this issue, adjust the `height` variable in either `VariableConfig.m` or `VariableConfiguration.m`. Experiment with decreasing or increasing its value to improve the scanning accuracy.


## Acknowledgements

**Main Developers/Engineers:** Alvarez | Dang | Tiguila | Segovia  


**Authors:** Jason Alvarez | Jonathan Dang | Jade de Jesus | Abraham Diaz | Marcos Olvera | Bryan Segovia | Prashant Tewary | Juan Tiguila | Kevin Velez | Erick Vergara

